# ZOOKEEPER学习笔记

**Zk是一个提供分布式协同服务的应用.例如集群服务器的数据的一致性、参数配置的一致性**


![image](https://colobu.com/images/logos/zookeeper.png)


## 运行原理:
zk通过创建znode节点,当客户端连接节点时,节点会分配会话ID并向客户端发确认函. 当客户端请求数据变化时. 会产生一个watcher监听事件(监听事件是用来处理当数据发生变化时处理回调方法).

<br/><br/>
> ## 自问自答环节

### 1.如果节点挂了.客户端怎么办
##### &emsp;&emsp;&emsp;Zk的每个znode都会维护一个stat，由版本号、 操作控制列表(ACL)，时间戳和数据长度组成。而节点会在一个配置好的周期时间发送确认给客户端.如果客户端接收超时.则会自动连到其他节点. 

### 2.客户端写入数据到znode的过程时怎样的
##### &emsp;&emsp;&emsp;Zk是主写从读的设计.结构是 一个master/多个follower.而其中涉及到数据复制的机制. 客户端的写请求统一发送的leader节点.由leader发起写请求. Quorum成功响应了(保证其数据一定能复制及q1中的情况).就开始写操作.
